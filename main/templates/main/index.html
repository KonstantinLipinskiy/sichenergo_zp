{% extends "main/base.html" %}
{% load static %}

{% block css %}
    <link rel="stylesheet" href='{% static "deps/css/style.css" %}'>
{% endblock css %}

{% block title %}
    {{title}}
{% endblock title %}

<body>
    {% block main %}
        <main class="main">
            <div class="container">
                <div class="main__row">
                    <!-- Блок последней новости -->
                    <div class="main__inform">
                        <div class="main__inform-title">ОСТАННІ ПОДІЇ</div>
                        <div class="main__inform-body">
                            <div class="main__inform-image">
                                {% if news.content_type == 'image' %}
                                    <img src="{{news.content_file.url}}" alt="{{news.title}}">
                                {% elif news.content_type == 'video' %}
                                    <video autoplay muted loop playsinline src="{{news.content_file.url}}"></video>
                                {% endif %}
                            </div>
                            <div class="main__inform-text">
                                <!-- Порядок: Регион → Заголовок → Дата -->
                                <div class="main__inform-text-region">Регіон {{news.region}}</div>
                                <div class="main__inform-text-title">{{news.title}}</div>
                                <div class="main__inform-text-date">{{news.created_at|date:"d.m.Y"}}</div>

                                <!-- Скрытый текст и рубрика для модалки -->
                                <div class="main__inform-text-text" style="display:none;">
                                    {{news.content|linebreaks}}
                                </div>
                                <div class="main__inform-text-heading" style="display:none;">
                                    Рубрика "{{news.heading}}"
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Блок продукции -->
                    <div class="main__content">
                        <h1>Обери свою продукцію</h1>
                        <div class="main__content-index-items">
                            {% for item in items %}
                                {% if item.title == 'Трансформатори' %} 
                                    <a class="index-link" href="{% url 'products:transformers' %}"> 
                                {% elif item.title == 'Трансформаторні підстанції' %}
                                    <a class="index-link" href="{% url 'products:ktp' %}">
                                {% elif item.title == 'Послуги' %}
                                    <a class="index-link" href="{% url 'service:service' %}">
                                {% endif %}
                                        <div class="main__content-index-item">
                                            <div class="main__content-index-video">
                                                <img src="{{item.image.url}}">
                                            </div>
                                            <div class="main__content-index-title">{{item.title}}</div>
                                        </div>
                                    </a>
                            {% endfor %}
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <!-- Модальное окно -->
        <div class="modal">
            <div class="modal-content">
                <span class="modal-close">&times;</span>
                <img class="modal-image" src="" alt=""/>
                <video autoplay muted loop playsinline class="modal-video" src="" controls></video>
                <div class="modal-text"></div>
            </div>
        </div>

        <script>
            function toggleMenu() {
                const menu = document.querySelector('.menu');
                menu.classList.toggle('active');
            }
        </script>
        <script src='{% static "deps/js/news-index.js" %}'></script>
    {% endblock main %}
</body>
</html>
